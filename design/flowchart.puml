@startuml
start

:Initialize simulation parameters;
:Create output directory;

repeat
  :Set random seed for replication;
  :Generate bug arrival times;

  :Initialize dev and QA server availability;
  :Initialize metrics (waiting_times, system_times, occupancy_intervals, throughput);

  while (More arrivals?) is (yes)
    :Get next arrival_time;
    :Set current_time = arrival_time;
    :Set lifecycle_start = arrival_time;

    repeat
      :Find available developer;
      if (Dev available now?) then (yes)
        :waiting_time = 0;
      else (no)
        :Wait for earliest dev;
        :waiting_time = wait;
        :current_time = dev available time;
      endif
      :Append waiting_time to waiting_times;
      :Sample dev_service time;
      :Update dev availability;
      :current_time += dev_service;

      :Find available QA;
      if (QA available now?) then (yes)
      else (no)
        :Wait for earliest QA;
        :current_time = QA available time;
      endif
      :Sample qa_service time;
      :Update QA availability;
      :current_time += qa_service;

      :Random QA decision;
      if (Rework?) then (yes)
        :Loop back to developer;
      else (no)
        :throughput += 1;
        :lifecycle_end = current_time;
        :Append system_time and occupancy_interval;
        break
      endif
    repeat while (Rework?)

  endwhile

  :Sample backlog over time;
  :Store replication metrics and backlog;

repeat while (More replications?)

:Aggregate metrics and backlog;
:Plot and save figures;
:Write markdown report;

stop
@enduml